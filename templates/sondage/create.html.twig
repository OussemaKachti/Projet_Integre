{% extends 'base.html.twig' %}

{% block title %}Créer un Sondage{% endblock %}

{% block body %}
    <div class="sidebar__widget mb-55">
        <div class="poll-creation-container">
            <h2>Create a Poll</h2>

            {{ form_start(form) }}
                <!-- Champ de la question -->
                <input type="text" class="input-box" placeholder="Type your question here"
                    {{ form_widget(form.question, {'attr': {'class': 'input-box'}}) }}>

                <h2>Options</h2>
                <div id="options-container">
                    {% for choix in form.choix %}
                        <div class="option-wrapper">
                            {{ form_widget(choix, {'attr': {'class': 'input-box'}}) }}
                        </div>
                    {% endfor %}
                </div>

                <!-- Bouton pour ajouter une option -->
                <button type="button" class="add-option" id="add-option">+ Add option</button>

                <!-- Message Administrateur -->
                <div class="admin-message">
                    <p><strong>Note:</strong> Ensure the question and options follow club rules.</p>
                </div>

                <!-- Bouton de soumission -->
                <button type="submit" class="create-btn">Create Poll</button>
            {{ form_end(form) }}
        </div>
    </div>

    <script>
        document.getElementById("add-option").addEventListener("click", function () {
            let optionsContainer = document.getElementById("options-container");
            let index = optionsContainer.children.length;
            
            // Créer un nouvel input en respectant la structure de Symfony
            let newOptionDiv = document.createElement("div");
            newOptionDiv.className = "option-wrapper";

            let newOption = document.createElement("input");
            newOption.type = "text";
            newOption.name = "sondage[choix][" + index + "][contenu]";
            newOption.className = "input-box";
            newOption.placeholder = "New Option";

            newOptionDiv.appendChild(newOption);
            optionsContainer.appendChild(newOptionDiv);
        });
    </script>
{% endblock %}
